<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>PID Control</title></head>
<body>
  <h2>PID Tuning for Self-Balancing Robot</h2>
  <p>
    Kp: <input id="kp" type="number" value="60" step="0.1"><br>
    Ki: <input id="ki" type="number" value="0.8" step="0.01"><br>
    Kd: <input id="kd" type="number" value="5" step="0.1"><br>
    Desired Angle: <input id="angle" type="number" value="0" step="0.1"><br>
    <button onclick="connect()">Connect & Send</button>
  </p>

  <script>
    let device, characteristic;
    async function connect() {
      device = await navigator.bluetooth.requestDevice({
        filters: [{ name: 'ESP32-BalanceBot' }],
        optionalServices: ['6e400001-b5a3-f393-e0a9-e50e24dcca9e']
      });

      const server = await device.gatt.connect();
      const service = await server.getPrimaryService('6e400001-b5a3-f393-e0a9-e50e24dcca9e');
      characteristic = await service.getCharacteristic('6e400002-b5a3-f393-e0a9-e50e24dcca9e');

      let kp = document.getElementById("kp").value;
      let ki = document.getElementById("ki").value;
      let kd = document.getElementById("kd").value;
      let angle = document.getElementById("angle").value;
      let message = `${kp},${ki},${kd},${angle}`;
      const encoder = new TextEncoder();
      await characteristic.writeValue(encoder.encode(message));
      alert("Parameters sent!");
    }
  </script>
</body>
</html>
